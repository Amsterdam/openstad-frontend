{% from 'number-plate.njk' import numberPlate %}

<style>
 {{data.widget.formattedContainerStyles}}
</style>

{% if data.widget.url %}
<a href="{{data.widget.url}}"
{% else %}
  <span
  {% endif %}
  id="{{data.widget.containerId}}"
  class="margin-bottom-xs scroll-link block no-decoration"
  >
	  <span class="box-blue block">
      <span class="flexcontainer">
        <span class="flexleft">
		      {{numberPlate(data.widget.count)}}
        </span>
        <span class="flexright">
          {{data.widget.label}}
        </span>
      </span>
	  </span>
    {% if data.widget.url %}
</a>
{% else %}
  </span>
  {% endif %}


  {% if data.widget.statsUrl %}
  <script>
   function fetchStats() {

     let url = '{{data.widget.statsUrl}}';
     fetch(url, {
	     headers: { "Content-type": "application/json" },
     })
	     .then((response) => {
		     if (!response.ok) throw Error(response)
		     return response.json();
	     })
	     .then( json => {
         json.count = 12345;
         let len = json.count.toString().length;
         count = ('000' + json.count).slice(-len);
         for (i=0; i<len; i++) {
           document.getElementById('counter-number-plate-'+i).innerHTML = count[i];
         }
	     })
	     .catch((err) => {
		     console.log('Niet goed');
		     console.log(err);
	     });
   }
   fetchStats()
  </script>
  {% endif %}
